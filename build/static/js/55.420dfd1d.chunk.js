(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[55],{1387:function(e,t,i){"use strict";i.r(t);var l=i(0),a=i(140),r=i(232),n=i(109),o=i(638),s=i(637),c=i(580),d=i(41),p=i(578),u=i.n(p),h=i(125),x=i(151),m=i(860),b=i(1);const{Option:f}=a.a;t.default=()=>{var e,t,i;const p=5===parseInt(localStorage.getItem("role")),y=Object(d.useHistory)(),{machineId:g,sensorId:j}=Object(d.useParams)(),v=Object(l.useRef)(null),O=Object(l.useRef)(null),_=Object(l.useRef)(null),A=(Object(l.useRef)(null),Object(l.useRef)(null),Object(l.useRef)(null)),S=(Object(l.useRef)(null),Object(l.useRef)(null),Object(l.useRef)(null)),[w,q]=Object(l.useState)("mid_freq_acceleration_p2p"),[F,z]=Object(l.useState)("x"),[D,M]=Object(l.useState)(j),[Y,H]=Object(l.useState)([]),[C,R]=Object(l.useState)("1"),[k,I]=Object(l.useState)(!1),[W,B]=Object(l.useState)(null),[V,T]=Object(l.useState)(null),[E,X]=Object(l.useState)(u()().subtract(1,"days").format("YYYY-MM-DD hh:mm:ss")),[L,$]=Object(l.useState)(u()().format("YYYY-MM-DD hh:mm:ss")),[Q,G]=Object(l.useState)([]),[J,U]=Object(l.useState)(!1),[P,Z]=Object(l.useState)([]),[K,N]=Object(l.useState)([]),[ee,te]=Object(l.useState)([]),[ie,le]=Object(l.useState)([]),[ae,re]=Object(l.useState)([]),[ne,oe]=Object(l.useState)([]),[se,ce]=Object(l.useState)([]),[de,pe]=Object(l.useState)([]),[ue,he]=Object(l.useState)([]),[xe,me]=Object(l.useState)([]),[be,fe]=Object(l.useState)([]),[ye,ge]=Object(l.useState)([]),[je,ve]=Object(l.useState)([]),[Oe,_e]=Object(l.useState)([]),[Ae,Se]=Object(l.useState)([]),[we,qe]=Object(l.useState)([]),[Fe,ze]=Object(l.useState)([]),[De,Me]=Object(l.useState)([]),[Ye,He]=Object(l.useState)([]),[Ce,Re]=Object(l.useState)([]),[ke,Ie]=Object(l.useState)({current:0}),[We,Be]=Object(l.useState)([]),[Ve,Te]=Object(l.useState)(!1),[Ee,Xe]=Object(l.useState)(null),[Le,$e]=Object(l.useState)(!1),[Qe,Ge]=Object(l.useState)(!1),[Je,Ue]=Object(l.useState)([]),[Pe,Ze]=Object(l.useState)([]),[Ke,Ne]=Object(l.useState)([]),[et,tt]=Object(l.useState)(!1),[it,lt]=Object(l.useState)({x:[],y:[],z:[]}),[at,rt]=Object(l.useState)([]),[nt,ot]=Object(l.useState)([]),[st,ct]=Object(l.useState)(null),[dt,pt]=Object(l.useState)([]),ut={mid_freq_acceleration_p2p:{label:"Mid Freq Acceleration",axes:["x","y","z"],unit:"(mm/s\xb2)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},high_freq_acceleration_p2p:{label:"High Freq Acceleration",axes:["z"],unit:"(mm/s\xb2)",colors:{z:"#f59e0b"},fileMapping:{z:"file_0"}},mid_freq_velocity:{label:"Mid Freq Velocity",axes:["x","y","z"],unit:"(mm/s)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},mid_freq_displacement:{label:"Mid Freq Displacement",axes:["x","y","z"],unit:"(\u03bcm)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},inclination:{label:"Inclination",axes:["x","y","z"],unit:"(degrees)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},mid_freq_env:{label:"Mid Freq Envelope",axes:["x","y","z"],unit:"(Hz)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},temperature:{label:"Temperature",axes:[""],unit:"(\xb0C)",colors:{"":"#f59e0b"},fileMapping:{"":null}},battery_voltage:{label:"Voltage",axes:[""],unit:"(V)",colors:{"":"#10b981"},fileMapping:{"":null}},battery_percentage:{label:"Battery %",axes:[""],unit:"(%)",colors:{"":"#3b82f6"},fileMapping:{"":null}},RSSI:{label:"RSSI",axes:[""],unit:"(dBm)",colors:{"":"#8b5cf6"},fileMapping:{"":null}}},ht=e=>{if(!Q||e>=Q.length)return"none";const t=Q[e],i=t.file_0&&""!==t.file_0.trim(),l=t.file_1&&""!==t.file_1.trim();return i&&l?"both":i?"mid-freq":l?"high-freq":"none"},xt=e=>{switch(e){case"both":return"#10b981";case"mid-freq":return"#3b82f6";case"high-freq":return"#f59e0b";case"none":return"#ef4444";default:return"#9ca3af"}},mt=async e=>{if(console.log("fetchAllSpectrumData called with pointData:",e),p)r.b.error("Advanced spectrum analysis is available for premium users only");else try{Te(!0),tt(!1),Ge(!1),Be([]),lt({x:[],y:[],z:[]}),rt([]),ot([]);const t=Q.findIndex((t=>u()(t.datetime).format("YYYY-MM-DD HH:mm:ss")===u()(e.x).format("YYYY-MM-DD HH:mm:ss")));if(-1===t)return void r.b.error("Could not find data record for this point");const i=Q[t],l=[];if(i.file_0&&""!==i.file_0.trim()&&l.push({type:"_0.bin",path:i.file_0,label:"3-axis mid-frequency"}),i.file_1&&""!==i.file_1.trim()&&l.push({type:"_1.bin",path:i.file_1,label:"1-axis high-frequency"}),console.log("Available files for analysis:",l),ot(l),0===l.length)return void r.b.error("No binary files available for spectrum analysis");const a=l.map((e=>bt(e.path,e.type))),n=await Promise.all(a);let o=!1,s=!1,c={x:[],y:[],z:[]},d=[];n.forEach(((e,t)=>{e.success?3===e.axes?(o=!0,c={x:e.data.x_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)])),y:e.data.y_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)])),z:e.data.z_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)]))}):1===e.axes&&(s=!0,d=e.data.map((e=>[parseFloat(e.x),parseFloat(e.y)]))):console.error(`Failed to process ${l[t].path}:`,e.error)})),o&&lt(c),s&&rt(d),o&&s?(tt(!0),console.log("Multiple spectrums available: 3-axis + 1-axis")):o?(Ge(!0),Ue(c.x),Ze(c.y),Ne(c.z),console.log("Single 3-axis spectrum available")):s&&(Ge(!1),Be(d),console.log("Single 1-axis spectrum available")),Xe(e),$e(!0)}catch(t){console.error("Error fetching spectrum data:",t),r.b.error("Error fetching spectrum data: "+t.message)}finally{Te(!1)}},bt=async(e,t)=>{const i=null===e||void 0===e?void 0:e.replace("uploads/",""),l=`api/getDataFromPythonScript?fileName=${i}`;console.log(`Fetching spectrum for: ${i} (expected: ${t})`);return(await h.axiosInstance.get(l)).data},ft=Object(l.useCallback)((e=>e&&0!==e.length?e.map(((e,t)=>[e.x instanceof Date?e.x.getTime():t,e.y||0])):[]),[]),yt=Object(l.useCallback)((e=>e&&0!==e.length?e:[]),[]),gt=(e,t)=>{if(!t)return[];const i=parseFloat(t)/60,l=["#ff0000","#00ff00","#0000ff","#ff8800"];return[1,2,3.3,4.2].map(((t,a)=>{const r=i*t;let n=0;if(e&&e.length>0){n=e.reduce(((e,t)=>{const[i,l]=t;return Math.abs(i-r)<Math.abs(e[0]-r)?t:e}))[1]}return{frequency:r,amplitude:n,multiplier:1===t?"1X":2===t?"2X":3.3===t?"3.3X":"4.2X",color:l[a]||"#666666"}}))},jt=Object(l.useCallback)(((e,t,i,l)=>{if(!v.current||!window.Highcharts)return;v.current.chart&&v.current.chart.destroy();const a=ft(e),r=e.map(((e,t)=>{const i=ht(t),l=xt(i);return{x:e.x instanceof Date?e.x.getTime():t,y:e.y,color:l,status:i}}));v.current.chart=window.Highcharts.stockChart(v.current,{chart:{height:450},title:{text:t},xAxis:{type:"datetime",title:{text:"Time"}},yAxis:{title:{text:`${t} ${i}`}},series:[{name:t,data:a,color:l,type:"line",point:{events:{click:function(t){const i=this.index,l=e[i];mt(l)}}}},{name:"File Availability",type:"scatter",data:r,marker:{enabled:!0,symbol:"circle",radius:4,states:{hover:{radius:6}}},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormatter:function(){return`<span style="color:${this.color}">\u25cf</span> Analysis: <b>${{both:"Both Mid & High Frequency","mid-freq":"Mid-Frequency Only","high-freq":"High-Frequency Only",none:"No Analysis Available"}[this.status]||"Unknown"}</b><br/>`}},point:{events:{click:function(t){const i=this.index,l=e[i];mt(l)}}}}],tooltip:{xDateFormat:"%Y-%m-%d %H:%M:%S",shared:!0},plotOptions:{line:{marker:{enabled:!1}}},legend:{enabled:!0,align:"right",verticalAlign:"top",layout:"vertical",x:-10,y:50,itemStyle:{fontSize:"10px"}}})}),[ft,mt,ht,xt,Q]),vt=Object(l.useCallback)((e=>{if(console.log("createSpectrumChart called with data length:",e?e.length:0),console.log("spectrumChartRef.current:",O.current),console.log("window.Highcharts available:",!!window.Highcharts),!O.current||!window.Highcharts)return void console.log("Missing ref or Highcharts, returning");O.current.chart&&(console.log("Destroying existing chart"),O.current.chart.destroy());const t=yt(e);console.log("Chart data prepared, length:",t.length),console.log("Sample chart data:",t.slice(0,3));const i=st&&st.rpm?gt(e,st.rpm):[];i.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),i.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));try{console.log("Creating Highcharts chart..."),O.current.chart=window.Highcharts.chart(O.current,{chart:{height:450,type:"line",zoomType:"xy"},title:{text:"Amplitude Spectrum"},xAxis:{title:{text:"Frequency (Hz)"}},yAxis:{title:{text:"Log Amplitude"}},series:[{name:"Amplitude Spectrum",data:t,color:"#ef4444",lineWidth:2,type:"line"}],legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}}}),console.log("Chart created successfully:",O.current.chart)}catch(l){console.error("Error creating spectrum chart:",l)}}),[yt,st,gt]),Ot=Object(l.useCallback)(((e,t,i)=>{if(console.log("create3AxisSpectrumCharts called - creating single combined chart"),!window.Highcharts)return void console.log("Highcharts not available");const l=st&&st.rpm?gt(i,st.rpm):[],a=l.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),r=l.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));_.current&&(_.current.chart&&_.current.chart.destroy(),_.current.chart=window.Highcharts.chart(_.current,{chart:{height:450,type:"line",zoomType:"xy"},title:{text:"3-Axis Mid-Frequency Spectrum Analysis"},subtitle:{text:"Combined X, Y, Z axes (fs=6664Hz, nperseg=4096)"},xAxis:{title:{text:"Frequency (Hz)"},gridLineWidth:1,plotLines:a},yAxis:{title:{text:"Log Amplitude (mm/s\xb2)\xb2/Hz"},gridLineWidth:1},series:[{name:"X-Axis",data:e,color:"#ef4444",lineWidth:2,type:"line"},{name:"Y-Axis",data:t,color:"#3b82f6",lineWidth:2,type:"line"},{name:"Z-Axis",data:i,color:"#10b981",lineWidth:2,type:"line"},...r],legend:{enabled:!0,align:"center",verticalAlign:"top",layout:"horizontal"},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}},tooltip:{shared:!0,crosshairs:!0,formatter:function(){let e="<b>Frequency: "+this.x.toFixed(2)+" Hz</b><br/>";return this.points.forEach((t=>{e+='<span style="color:'+t.color+'">'+t.series.name+": "+t.y.toFixed(4)+"</span><br/>"})),e}}}))}),[st,gt]),_t=Object(l.useCallback)(((e,t)=>{if(console.log("createMultiSpectrumCharts called"),!window.Highcharts)return void console.log("Highcharts not available");const i=st&&st.rpm?gt(e.z,st.rpm):[],l=st&&st.rpm?gt(t,st.rpm):[],a=i.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),r=(l.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),i.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}}))));l.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));A.current&&(A.current.chart&&A.current.chart.destroy(),A.current.chart=window.Highcharts.chart(A.current,{chart:{height:420,type:"line",zoomType:"xy"},title:{text:"3-Axis Mid-Frequency Spectrum Analysis"},subtitle:{text:"Combined X, Y, Z axes (fs=6664Hz, nperseg=4096)"},xAxis:{title:{text:"Frequency (Hz)"},gridLineWidth:1,plotLines:a},yAxis:{title:{text:"Log Amplitude (mm/s\xb2)\xb2/Hz"},gridLineWidth:1},series:[{name:"X-Axis",data:e.x,color:"#ef4444",lineWidth:2,type:"line"},{name:"Y-Axis",data:e.y,color:"#3b82f6",lineWidth:2,type:"line"},{name:"Z-Axis",data:e.z,color:"#10b981",lineWidth:2,type:"line"},...r],legend:{enabled:!0,align:"center",verticalAlign:"top",layout:"horizontal"},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}},tooltip:{shared:!0,crosshairs:!0,formatter:function(){let e="<b>Frequency: "+this.x.toFixed(2)+" Hz</b><br/>";return this.points.forEach((t=>{e+='<span style="color:'+t.color+'">'+t.series.name+": "+t.y.toFixed(4)+"</span><br/>"})),e}}})),S.current&&(S.current.chart&&S.current.chart.destroy(),S.current.chart=window.Highcharts.chart(S.current,{chart:{height:370,type:"line",zoomType:"xy"},title:{text:"1-Axis High-Frequency Spectrum Analysis"},subtitle:{text:"Single axis (fs=2560Hz, nperseg=65536)"},xAxis:{title:{text:"Frequency (Hz)"}},yAxis:{title:{text:"Log Amplitude"}},series:[{name:"1-Axis PSD",data:t,color:"#f59e0b",lineWidth:2,type:"line"}],legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}}}))}),[st,gt]);Object(l.useEffect)((()=>{At(),St(),j&&(M(j),wt(j,E,L))}),[g,j]);const At=async()=>{try{const e=(await h.axiosInstance.get(`api/web/machines/${g}`)).data.item;if(ct(e),e&&e.rpm){const t=parseFloat(e.rpm)/60;pt([{multiplier:1,frequency:t,label:"1X",color:"#ff0000"},{multiplier:2,frequency:2*t,label:"2X",color:"#00ff00"},{multiplier:3,frequency:3*t,label:"3X",color:"#0000ff"},{multiplier:3.4,frequency:3.4*t,label:"3.4X",color:"#ff8800"},{multiplier:4,frequency:4*t,label:"4X",color:"#8800ff"},{multiplier:4.2,frequency:4.2*t,label:"4.2X",color:"#00ffff"}])}}catch(e){console.error("Error fetching machine data:",e)}},St=async()=>{try{const e=await h.axiosInstance.get(`api/web/machines/${g}/sensors`);H(e.data.items||[])}catch(e){console.error("Error fetching sensors data:",e)}},wt=async(e,t,i)=>{try{U(!0);const l=(await h.axiosInstance.get(`api/machine-data?machine_id=${g}&deviceID=${e}&start_date=${t}&end_date=${i}`)).data.data;G(l),Z((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),N((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),te((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),le((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.high_freq_acceleration_p2p_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),re((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),oe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),ce((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),pe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),he((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),me((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),fe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),ge((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),ve((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),_e((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),Se((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),qe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),ze((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.temperature)||0}))))),Me((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.battery_percentage)||0}))))),He((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.battery_voltage)||0}))))),Re((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.RSSI)||0})))))}catch(l){console.error("Error fetching sensor data:",l)}finally{U(!1)}};return Object(l.useEffect)((()=>{var e;const t={mid_freq_acceleration_p2p_x:P,mid_freq_acceleration_p2p_y:K,mid_freq_acceleration_p2p_z:ee,high_freq_acceleration_p2p_z:ie,mid_freq_velocity_x:de,mid_freq_velocity_y:ue,mid_freq_velocity_z:xe,mid_freq_displacement_x:ae,mid_freq_displacement_y:ne,mid_freq_displacement_z:se,inclination_x:Oe,inclination_y:Ae,inclination_z:we,mid_freq_env_x:be,mid_freq_env_y:ye,mid_freq_env_z:je,temperature_:Fe,battery_voltage_:Ye,battery_percentage_:De,RSSI_:Ce}[`${w}_${F}`]||[],i=ut[w],l=(null===i||void 0===i||null===(e=i.colors)||void 0===e?void 0:e[F])||"#ef4444",a=(null===i||void 0===i?void 0:i.unit)||"",r=`${(null===i||void 0===i?void 0:i.label)||""} ${F.toUpperCase()}`;t.length>0&&jt(t,r,a,l)}),[w,F,Q,jt]),Object(l.useEffect)((()=>{We&&We.length>0&&Le&&!Qe&&!et&&(console.log("Creating single-axis spectrum chart with data length:",We.length),setTimeout((()=>{vt(We)}),100))}),[We,vt,Le,Qe,et]),Object(l.useEffect)((()=>{Qe&&Le&&!et&&Je&&Je.length>0&&Pe&&Pe.length>0&&Ke&&Ke.length>0&&(console.log("Creating 3-axis spectrum chart"),setTimeout((()=>{Ot(Je,Pe,Ke)}),100))}),[Je,Pe,Ke,Ot,Le,Qe,et]),Object(l.useEffect)((()=>{et&&Le&&it&&at&&at.length>0&&(console.log("Creating multi-spectrum charts"),setTimeout((()=>{_t(it,at)}),100))}),[it,at,_t,Le,et]),Object(l.useEffect)((()=>{p&&(r.b.error("Access Denied: Sensor analysis is only available for premium users. Please upgrade your plan."),y.push(`/app/machine-and-sensors/machine-details/${g}`))}),[p,y,g]),p?null:Object(b.jsxs)("div",{style:{padding:"20px"},children:[Object(b.jsx)("div",{style:{marginBottom:"20px"},children:Object(b.jsx)(n.a,{onClick:()=>y.push(`/app/machine-and-sensors/machine-details/${g}`),children:"\u2190 Back to Machine Details"})}),Object(b.jsxs)(o.a,{children:[Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",gap:"15px"},children:[Object(b.jsx)("div",{children:Object(b.jsx)("img",{src:m.a,alt:"Series"})}),Object(b.jsxs)("div",{style:{fontWeight:"bold",fontSize:"16px"},children:["Sensor Analysis ",p&&Object(b.jsx)("span",{style:{color:"#f59e0b"},children:"(Limited Features)"})]}),Object(b.jsx)("div",{children:Object(b.jsx)(n.a,{type:"primary",disabled:0===Q.length,loading:J,onClick:()=>(async(e,t,i)=>{if(0===Q.length)return void r.b.error("No data found");let l=`${x.a}/api/downloadMultipleRawFilesAndZipAndServe?machine_id=${g}&deviceID=${e}&start_date=${t}&end_date=${i}`;window.open(l,"_blank")})(D,E,L),children:"Acquire Raw Data"})}),Object(b.jsx)("div",{style:{width:"200px"},children:Object(b.jsxs)(a.a,{value:C,onChange:e=>{if("Date Range"===e)return void I(!0);let t,i;R(e),"1"===e?(t=u()().subtract(1,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"7"===e?(t=u()().subtract(7,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"30"===e?(t=u()().subtract(30,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"60"===e&&(t=u()().subtract(60,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")),X(t),$(i),D&&wt(D,t,i)},style:{width:"100%"},children:[Object(b.jsx)(a.a.Option,{value:"1",children:"1 Day"}),Object(b.jsx)(a.a.Option,{value:"7",children:"7 Day"}),Object(b.jsx)(a.a.Option,{value:"30",children:"30 Day"}),Object(b.jsx)(a.a.Option,{value:"60",children:"60 Day"}),Object(b.jsx)(a.a.Option,{value:"Date Range",children:"Date Range"})]})})]}),Object(b.jsx)("div",{style:{width:"300px",marginBottom:"30px"},children:Object(b.jsx)(a.a,{value:D,placeholder:"Select Sensor",onChange:e=>{M(e),localStorage.setItem("deviceId2",e),wt(e,E,L)},style:{width:"100%"},children:Y.map((e=>Object(b.jsx)(f,{value:e.sensor_id,children:e.sensor_type+" #"+(null!==e.sensor_id_label?e.sensor_id_label:e.sensor_id)},e.sensor_id)))})}),Le&&Object(b.jsxs)(o.a,{title:Object(b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(b.jsx)("span",{children:et?"Analysis":Qe?`3-Axis Combined Spectrum (${Je?Je.length:0} points per axis)`:`Amplitude Spectrum (${We?We.length:0} points)`}),Object(b.jsx)(n.a,{size:"small",onClick:()=>$e(!1),children:"\u2715 Close"})]}),style:{marginBottom:"20px"},loading:Ve,children:[Ee&&Object(b.jsxs)("div",{style:{marginBottom:"15px",padding:"10px",background:"#f0f2f5",borderRadius:"6px"},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("strong",{children:"Time:"})," ",u()(Ee.x).format("DD-MM-YYYY HH:mm:ss")]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("strong",{children:"Value:"})," ","number"===typeof Ee.y?Ee.y.toFixed(2):Ee.y," ",(null===(e=ut[w])||void 0===e?void 0:e.unit)||""]})]}),!et&&Qe&&Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(b.jsx)("h3",{style:{color:"#1890ff",marginBottom:"15px"},children:"3-Axis Mid-Frequency Spectrum Analysis"}),Object(b.jsx)("div",{style:{width:"100%",height:"470px",overflowX:"auto"},children:Object(b.jsx)("div",{ref:_,style:{width:"100%",height:"470px"}})})]})}),!et&&!Qe&&Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(b.jsx)("h3",{style:{color:"#fa8c16",marginBottom:"15px"},children:"1-Axis High-Frequency Spectrum Analysis"}),Object(b.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[Object(b.jsx)("div",{style:{flex:1,height:"470px",overflowX:"auto"},children:Object(b.jsx)("div",{ref:O,style:{width:"100%",height:"470px"}})}),st&&Object(b.jsx)("div",{style:{flexShrink:0},children:Object(b.jsxs)("div",{style:{width:"250px",border:"3px solid #fa8c16",borderRadius:"8px",padding:"12px",background:"#fff7e6"},children:[Object(b.jsx)("div",{style:{background:"#fa8c16",color:"white",padding:"6px",textAlign:"center",fontWeight:"bold",borderRadius:"4px",marginBottom:"10px"},children:"Harmonics of Rotational Frequency"}),Object(b.jsx)("table",{style:{width:"100%",fontSize:"12px"},children:Object(b.jsx)("tbody",{children:gt(We,st.rpm).map(((e,t)=>Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{style:{color:e.color,fontWeight:"bold",paddingRight:"8px"},children:"\u25cf"}),Object(b.jsxs)("td",{style:{fontWeight:"bold"},children:[t+1,"st Order @"]}),Object(b.jsxs)("td",{style:{color:e.color,fontWeight:"bold",textAlign:"right"},children:[e.frequency.toFixed(1)," Hz"]}),Object(b.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:e.multiplier})]},t)))})})]})})]})]})}),et&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(b.jsx)("h3",{style:{color:"#1890ff",marginBottom:"15px"},children:"Mid-Frequency Analysis"}),Object(b.jsx)("div",{style:{width:"100%",height:"420px",overflowX:"auto"},children:Object(b.jsx)("div",{ref:A,style:{width:"100%",height:"420px"}})})]}),Object(b.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(b.jsx)("h3",{style:{color:"#fa8c16",marginBottom:"15px"},children:"High-Frequency Analysis"}),Object(b.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[Object(b.jsx)("div",{style:{flex:1,height:"370px",overflowX:"auto"},children:Object(b.jsx)("div",{ref:S,style:{width:"100%",height:"370px"}})}),st&&Object(b.jsx)("div",{style:{flexShrink:0},children:Object(b.jsxs)("div",{style:{width:"250px",border:"3px solid #1890ff",borderRadius:"8px",padding:"12px",background:"#e6f7ff"},children:[Object(b.jsx)("div",{style:{background:"#1890ff",color:"white",padding:"6px",textAlign:"center",fontWeight:"bold",borderRadius:"4px",marginBottom:"10px"},children:"Harmonics of Rotational Frequency"}),Object(b.jsx)("table",{style:{width:"100%",fontSize:"12px"},children:Object(b.jsx)("tbody",{children:gt(null,st.rpm).map(((e,t)=>Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{style:{color:e.color,fontWeight:"bold",paddingRight:"8px"},children:"\u25cf"}),Object(b.jsxs)("td",{style:{fontWeight:"bold"},children:[t+1,"st Order @"]}),Object(b.jsxs)("td",{style:{color:e.color,fontWeight:"bold",textAlign:"right"},children:[e.frequency.toFixed(1)," Hz"]}),Object(b.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:e.multiplier})]},t)))})})]})})]})]})]})]}),Object(b.jsx)(o.a,{title:Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[Object(b.jsx)("span",{children:"Trend"}),Object(b.jsx)("div",{style:{display:"flex",gap:"5px"},children:Object.entries(ut).map((e=>{let[t,i]=e;return Object(b.jsx)("button",{onClick:()=>(e=>{var t;q(e);const i=(null===(t=ut[e])||void 0===t?void 0:t.axes)||["x"];z(i[0])})(t),style:{padding:"4px 12px",fontSize:"12px",border:"none",borderRadius:"15px",cursor:"pointer",backgroundColor:w===t?"#1890ff":"rgba(255, 255, 255, 0.1)",color:w===t?"white":"#666",transition:"all 0.2s ease"},children:i.label},t)}))})]}),((null===(t=ut[w])||void 0===t?void 0:t.axes)||[]).filter((e=>""!==e)).length>0&&Object(b.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:((null===(i=ut[w])||void 0===i?void 0:i.axes)||[]).filter((e=>""!==e)).map((e=>{var t,i;return Object(b.jsx)("button",{onClick:()=>{z(e)},style:{padding:"6px 16px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"15px",cursor:"pointer",backgroundColor:F===e?(null===(t=ut[w])||void 0===t||null===(i=t.colors)||void 0===i?void 0:i[e])||"#1890ff":"rgba(255, 255, 255, 0.1)",color:F===e?"white":"#666",transition:"all 0.2s ease",minWidth:"45px"},children:e.toUpperCase()},e)}))}),Object(b.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"15px",fontSize:"11px",color:"#666"},children:[Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(b.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#10b981"}}),Object(b.jsx)("span",{children:"Both Analyses"})]}),Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(b.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#3b82f6"}}),Object(b.jsx)("span",{children:"Mid-Frequency"})]}),Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(b.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b"}}),Object(b.jsx)("span",{children:"High-Frequency"})]}),Object(b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(b.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#ef4444"}}),Object(b.jsx)("span",{children:"No Analysis"})]})]})]}),style:{marginBottom:"20px"},children:Object(b.jsx)("div",{style:{width:"100%",height:"450px",overflowX:"auto"},children:Object(b.jsx)("div",{ref:v,style:{width:"100%",height:"450px"}})})})]}),Object(b.jsxs)(s.a,{title:"Select Date Range",visible:k,onOk:()=>{if(W&&V){const e=u()(W).format("YYYY-MM-DD hh:mm:ss"),t=u()(V).format("YYYY-MM-DD hh:mm:ss");X(e),$(t),R("Date-Range"),D&&wt(D,e,t)}I(!1)},onCancel:()=>I(!1),children:[Object(b.jsxs)("div",{style:{marginBottom:"16px"},children:[Object(b.jsx)("label",{children:"Start Date:"}),Object(b.jsx)(c.a,{showTime:!0,value:W?u()(W):null,onChange:e=>B(e),style:{width:"100%",marginTop:"8px"}})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"End Date:"}),Object(b.jsx)(c.a,{showTime:!0,value:V?u()(V):null,onChange:e=>T(e),style:{width:"100%",marginTop:"8px"}})]})]})]})}},860:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANCSURBVHgB7VVNSFRRFP7um5dmCU0gZCDkIkipQEixRYtctRIKZyaFQocIUionyJWFCrVoEc74R1GgQaGoocEEQoRCLRRdKAkVuDBo4SJqqBEGZ967fe/OjD8wozNjtig/uPPu3HPu/c4595xzgV386xApaY147Fgxq2ET5TBlUXSnCEFiEprxDI6uT0gTWxMPeuqgyXaS2AFJMrHEXQFKCjnssVP6aFQbLngXkSK0TaXDHi+E7IVJImHUI6gdxrK9GLqogNN3EBGjjAb1cdTBkOOMTCFSRHKPhzyt9LCFGqMww5ehZZ2GlM2UnI1pfKPMrzwNc03gCfWXEBQn4fYGkJHHynKSSszjw5wTIqsL0jy3jtRCnvI0IqexfGCAkXFzrQC5shMpIDGxQVL1FZU4UXKHnp6i6utVucQCx+KqATnfS/BL+CkY4/9LGGzIR9rEvS17+XueYwL7bUF60sj5AnTMrimZY9zpV1MhJ3nn5cg1qac9iMr1i0ib2N0W4n3dg9CaEAqXqmwWLJtoFsfJh1lW0QiYCDLT8zirhlyZUZkvRCnSJrZQ5XsIR/sMDziiQipIGJZXVBQk58ImYJMBFQlNkAwkEkVw9QRVuVl3nRGx1TAs7Au/4kG3OIoZUge/cyTwqfCbWi1M0cQ8mIpGQy7FTrQzJyLYAnrC1Yj8iKGbo/jJO9PlSHRRQNW0BRk3W15bt2uABpdwr13de0YeA2yBohoh1aH8SAUG7rOeHTEjJ7ZST0JsPoXVDnPRDM2sX1c6SSBbka0FGYFGpevseIuMiJ2dL2i1laG3EbY5eI8VXH2eQJOtVFxHdqhbtUxJUw3hRgrQk0oicMKGcWZvO0umADLMRMq6C5tZRIJDTKDPfJnmgaxSrORMc62Qhj5CjW8CKWDz1+nljQJmbz9nZ5R3kuUEOcVvgGV0jLvZvzmgciGiHJHiKlzeYWyLOA7raRSyFht7NSG/sqT6oJuPYRjseHve8ERGR5SRfHb7xHH0sr5zzAJomg5b+Aequr9sNLDhKIQ+zmNzeRU1cHWM/RniVNDPl00338XIK0n+Hn+F2MKa5/nJwr4zxBvJE3quYafg6uGbHalQFSDkceziv8Nv8F43RRMAsBQAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=55.420dfd1d.chunk.js.map