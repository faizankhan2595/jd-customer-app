(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[56],{1407:function(e,t,i){"use strict";i.r(t);var l=i(0),a=i(139),r=i(231),o=i(110),n=i(639),s=i(638),c=i(580),d=i(41),p=i(578),u=i.n(p),h=i(97),x=i(257),b=i(865),m=i(1);const{Option:f}=a.a;t.default=()=>{var e,t;const i=5===parseInt(localStorage.getItem("role")),p=Object(l.useRef)(null),y=Object(l.useRef)(null),g=Object(l.useRef)(null),j=(Object(l.useRef)(null),Object(l.useRef)(null),Object(l.useRef)(null)),v=(Object(l.useRef)(null),Object(l.useRef)(null),Object(l.useRef)(null)),O=Object(d.useHistory)(),{machineId:_,sensorId:A}=Object(d.useParams)(),[S,w]=Object(l.useState)("mid_freq_acceleration_p2p"),[q,F]=Object(l.useState)("x"),[z,D]=Object(l.useState)(A),[M,Y]=Object(l.useState)([]),[H,C]=Object(l.useState)("1"),[R,k]=Object(l.useState)(!1),[I,W]=Object(l.useState)(null),[B,V]=Object(l.useState)(null),[T,E]=Object(l.useState)(u()().subtract(1,"days").format("YYYY-MM-DD hh:mm:ss")),[X,L]=Object(l.useState)(u()().format("YYYY-MM-DD hh:mm:ss")),[Q,$]=Object(l.useState)([]),[G,J]=Object(l.useState)(!1),[U,P]=Object(l.useState)([]),[Z,K]=Object(l.useState)([]),[N,ee]=Object(l.useState)([]),[te,ie]=Object(l.useState)([]),[le,ae]=Object(l.useState)([]),[re,oe]=Object(l.useState)([]),[ne,se]=Object(l.useState)([]),[ce,de]=Object(l.useState)([]),[pe,ue]=Object(l.useState)([]),[he,xe]=Object(l.useState)([]),[be,me]=Object(l.useState)([]),[fe,ye]=Object(l.useState)([]),[ge,je]=Object(l.useState)([]),[ve,Oe]=Object(l.useState)([]),[_e,Ae]=Object(l.useState)([]),[Se,we]=Object(l.useState)([]),[qe,Fe]=Object(l.useState)([]),[ze,De]=Object(l.useState)([]),[Me,Ye]=Object(l.useState)([]),[He,Ce]=Object(l.useState)([]),[Re,ke]=Object(l.useState)({current:0}),[Ie,We]=Object(l.useState)([]),[Be,Ve]=Object(l.useState)(!1),[Te,Ee]=Object(l.useState)(null),[Xe,Le]=Object(l.useState)(!1),[Qe,$e]=Object(l.useState)(!1),[Ge,Je]=Object(l.useState)([]),[Ue,Pe]=Object(l.useState)([]),[Ze,Ke]=Object(l.useState)([]),[Ne,et]=Object(l.useState)(!1),[tt,it]=Object(l.useState)({x:[],y:[],z:[]}),[lt,at]=Object(l.useState)([]),[rt,ot]=Object(l.useState)([]),[nt,st]=Object(l.useState)(null),[ct,dt]=Object(l.useState)([]),pt={mid_freq_acceleration_p2p:{label:"Mid Freq Acceleration",axes:["x","y","z"],unit:"(mm/s\xb2)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},high_freq_acceleration_p2p:{label:"High Freq Acceleration",axes:["z"],unit:"(mm/s\xb2)",colors:{z:"#f59e0b"},fileMapping:{z:"file_0"}},mid_freq_velocity:{label:"Mid Freq Velocity",axes:["x","y","z"],unit:"(mm/s)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},mid_freq_displacement:{label:"Mid Freq Displacement",axes:["x","y","z"],unit:"(\u03bcm)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},inclination:{label:"Inclination",axes:["x","y","z"],unit:"(degrees)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},mid_freq_env:{label:"Mid Freq Envelope",axes:["x","y","z"],unit:"(Hz)",colors:{x:"#ef4444",y:"#3b82f6",z:"#10b981"},fileMapping:{x:"file_1",y:"file_2",z:"file_0"}},temperature:{label:"Temperature",axes:[""],unit:"(\xb0C)",colors:{"":"#f59e0b"},fileMapping:{"":null}},battery_voltage:{label:"Voltage",axes:[""],unit:"(V)",colors:{"":"#10b981"},fileMapping:{"":null}},battery_percentage:{label:"Battery %",axes:[""],unit:"(%)",colors:{"":"#3b82f6"},fileMapping:{"":null}},RSSI:{label:"RSSI",axes:[""],unit:"(dBm)",colors:{"":"#8b5cf6"},fileMapping:{"":null}}},ut=e=>{if(!Q||e>=Q.length)return"none";const t=Q[e],i=t.file_0&&""!==t.file_0.trim(),l=t.file_1&&""!==t.file_1.trim();return i&&l?"both":i?"mid-freq":l?"high-freq":"none"},ht=e=>{switch(e){case"both":return"#10b981";case"mid-freq":return"#3b82f6";case"high-freq":return"#f59e0b";case"none":return"#ef4444";default:return"#9ca3af"}},xt=async e=>{if(console.log("fetchAllSpectrumData called with pointData:",e),i)r.b.error("Advanced spectrum analysis is available for premium users only");else try{Ve(!0),et(!1),$e(!1),We([]),it({x:[],y:[],z:[]}),at([]),ot([]);const t=Q.findIndex((t=>u()(t.datetime).format("YYYY-MM-DD HH:mm:ss")===u()(e.x).format("YYYY-MM-DD HH:mm:ss")));if(-1===t)return void r.b.error("Could not find data record for this point");const i=Q[t],l=[];if(i.file_0&&""!==i.file_0.trim()&&l.push({type:"_0.bin",path:i.file_0,label:"3-axis mid-frequency"}),i.file_1&&""!==i.file_1.trim()&&l.push({type:"_1.bin",path:i.file_1,label:"1-axis high-frequency"}),console.log("Available files for analysis:",l),ot(l),0===l.length)return void r.b.error("No binary files available for spectrum analysis");const a=l.map((e=>bt(e.path,e.type))),o=await Promise.all(a);let n=!1,s=!1,c={x:[],y:[],z:[]},d=[];o.forEach(((e,t)=>{e.success?3===e.axes?(n=!0,c={x:e.data.x_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)])),y:e.data.y_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)])),z:e.data.z_axis.map((e=>[parseFloat(e.x),parseFloat(e.y)]))}):1===e.axes&&(s=!0,d=e.data.map((e=>[parseFloat(e.x),parseFloat(e.y)]))):console.error(`Failed to process ${l[t].path}:`,e.error)})),n&&it(c),s&&at(d),n&&s?(et(!0),console.log("Multiple spectrums available: 3-axis + 1-axis")):n?($e(!0),Je(c.x),Pe(c.y),Ke(c.z),console.log("Single 3-axis spectrum available")):s&&($e(!1),We(d),console.log("Single 1-axis spectrum available")),Ee(e),Le(!0)}catch(t){console.error("Error fetching spectrum data:",t),r.b.error("Error fetching spectrum data: "+t.message)}finally{Ve(!1)}},bt=async(e,t)=>{const i=null===e||void 0===e?void 0:e.replace("uploads/",""),l=`api/getDataFromPythonScript?fileName=${i}`;console.log(`Fetching spectrum for: ${i} (expected: ${t})`);return(await h.axiosInstance.get(l)).data},mt=Object(l.useCallback)((e=>e&&0!==e.length?e.map(((e,t)=>[e.x instanceof Date?e.x.getTime():t,e.y||0])):[]),[]),ft=Object(l.useCallback)((e=>e&&0!==e.length?e:[]),[]),yt=(e,t)=>{if(!t)return[];const i=parseFloat(t)/60,l=["#ff0000","#00ff00","#0000ff","#ff8800"];return[1,2,3.3,4.2].map(((t,a)=>{const r=i*t;let o=0;if(e&&e.length>0){o=e.reduce(((e,t)=>{const[i,l]=t;return Math.abs(i-r)<Math.abs(e[0]-r)?t:e}))[1]}return{frequency:r,amplitude:o,multiplier:1===t?"1X":2===t?"2X":3.3===t?"3.3X":"4.2X",color:l[a]||"#666666"}}))},gt=Object(l.useCallback)(((e,t,i,l)=>{if(!p.current||!window.Highcharts)return;p.current.chart&&p.current.chart.destroy();const a=mt(e),r=e.map(((e,t)=>{const i=ut(t),l=ht(i);return{x:e.x instanceof Date?e.x.getTime():t,y:e.y,color:l,status:i}}));p.current.chart=window.Highcharts.stockChart(p.current,{chart:{height:450},title:{text:t},xAxis:{type:"datetime",title:{text:"Time"}},yAxis:{title:{text:`${t} ${i}`}},series:[{name:t,data:a,color:l,type:"line",point:{events:{click:function(t){const i=this.index,l=e[i];xt(l)}}}},{name:"File Availability",type:"scatter",data:r,marker:{enabled:!0,symbol:"circle",radius:4,states:{hover:{radius:6}}},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormatter:function(){return`<span style="color:${this.color}">\u25cf</span> Analysis: <b>${{both:"Both Mid & High Frequency","mid-freq":"Mid-Frequency Only","high-freq":"High-Frequency Only",none:"No Analysis Available"}[this.status]||"Unknown"}</b><br/>`}},point:{events:{click:function(t){const i=this.index,l=e[i];xt(l)}}}}],tooltip:{xDateFormat:"%Y-%m-%d %H:%M:%S",shared:!0},plotOptions:{line:{marker:{enabled:!1}}},legend:{enabled:!0,align:"right",verticalAlign:"top",layout:"vertical",x:-10,y:50,itemStyle:{fontSize:"10px"}}})}),[mt,xt,ut,ht,Q]),jt=Object(l.useCallback)((e=>{if(console.log("createSpectrumChart called with data length:",e?e.length:0),console.log("spectrumChartRef.current:",y.current),console.log("window.Highcharts available:",!!window.Highcharts),!y.current||!window.Highcharts)return void console.log("Missing ref or Highcharts, returning");y.current.chart&&(console.log("Destroying existing chart"),y.current.chart.destroy());const t=ft(e);console.log("Chart data prepared, length:",t.length),console.log("Sample chart data:",t.slice(0,3));const i=nt&&nt.rpm?yt(e,nt.rpm):[];i.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),i.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));try{console.log("Creating Highcharts chart..."),y.current.chart=window.Highcharts.chart(y.current,{chart:{height:450,type:"line",zoomType:"xy"},title:{text:"Amplitude Spectrum"},xAxis:{title:{text:"Frequency (Hz)"}},yAxis:{title:{text:"Log Amplitude"}},series:[{name:"Amplitude Spectrum",data:t,color:"#ef4444",lineWidth:2,type:"line"}],legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}}}),console.log("Chart created successfully:",y.current.chart)}catch(l){console.error("Error creating spectrum chart:",l)}}),[ft,nt,yt]),vt=Object(l.useCallback)(((e,t,i)=>{if(console.log("create3AxisSpectrumCharts called - creating single combined chart"),!window.Highcharts)return void console.log("Highcharts not available");const l=nt&&nt.rpm?yt(i,nt.rpm):[],a=l.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),r=l.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));g.current&&(g.current.chart&&g.current.chart.destroy(),g.current.chart=window.Highcharts.chart(g.current,{chart:{height:450,type:"line",zoomType:"xy"},title:{text:"3-Axis Mid-Frequency Spectrum Analysis"},subtitle:{text:"Combined X, Y, Z axes (fs=6664Hz, nperseg=4096)"},xAxis:{title:{text:"Frequency (Hz)"},gridLineWidth:1,plotLines:a},yAxis:{title:{text:"Log Amplitude (m/s\xb2)\xb2/Hz"},gridLineWidth:1},series:[{name:"X-Axis",data:e,color:"#ef4444",lineWidth:2,type:"line"},{name:"Y-Axis",data:t,color:"#3b82f6",lineWidth:2,type:"line"},{name:"Z-Axis",data:i,color:"#10b981",lineWidth:2,type:"line"},...r],legend:{enabled:!0,align:"center",verticalAlign:"top",layout:"horizontal"},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}},tooltip:{shared:!0,crosshairs:!0,formatter:function(){let e="<b>Frequency: "+this.x.toFixed(2)+" Hz</b><br/>";return this.points.forEach((t=>{e+='<span style="color:'+t.color+'">'+t.series.name+": "+t.y.toFixed(4)+"</span><br/>"})),e}}}))}),[nt,yt]),Ot=Object(l.useCallback)(((e,t)=>{if(console.log("createMultiSpectrumCharts called"),!window.Highcharts)return void console.log("Highcharts not available");const i=nt&&nt.rpm?yt(e.z,nt.rpm):[],l=nt&&nt.rpm?yt(t,nt.rpm):[],a=i.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),r=(l.map((e=>({color:e.color,width:2,value:e.frequency,dashStyle:"solid",label:{text:e.multiplier,style:{color:e.color,fontWeight:"bold",fontSize:"11px"},align:"center",verticalAlign:"bottom",y:-5}}))),i.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}}))));l.map((e=>({name:`Harmonic ${e.multiplier}`,type:"scatter",data:[[e.frequency,e.amplitude||0]],color:e.color,marker:{symbol:"circle",radius:5,fillColor:e.color,lineColor:e.color,lineWidth:2},showInLegend:!1,enableMouseTracking:!0,tooltip:{pointFormat:"<b>{point.x:.1f} Hz</b><br/>Harmonic: <b>"+e.multiplier+"</b>"}})));j.current&&(j.current.chart&&j.current.chart.destroy(),j.current.chart=window.Highcharts.chart(j.current,{chart:{height:420,type:"line",zoomType:"xy"},title:{text:"3-Axis Mid-Frequency Spectrum Analysis"},subtitle:{text:"Combined X, Y, Z axes (fs=6664Hz, nperseg=4096)"},xAxis:{title:{text:"Frequency (Hz)"},gridLineWidth:1,plotLines:a},yAxis:{title:{text:"Log Amplitude (m/s\xb2)\xb2/Hz"},gridLineWidth:1},series:[{name:"X-Axis",data:e.x,color:"#ef4444",lineWidth:2,type:"line"},{name:"Y-Axis",data:e.y,color:"#3b82f6",lineWidth:2,type:"line"},{name:"Z-Axis",data:e.z,color:"#10b981",lineWidth:2,type:"line"},...r],legend:{enabled:!0,align:"center",verticalAlign:"top",layout:"horizontal"},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}},tooltip:{shared:!0,crosshairs:!0,formatter:function(){let e="<b>Frequency: "+this.x.toFixed(2)+" Hz</b><br/>";return this.points.forEach((t=>{e+='<span style="color:'+t.color+'">'+t.series.name+": "+t.y.toFixed(4)+"</span><br/>"})),e}}})),v.current&&(v.current.chart&&v.current.chart.destroy(),v.current.chart=window.Highcharts.chart(v.current,{chart:{height:370,type:"line",zoomType:"xy"},title:{text:"1-Axis High-Frequency Spectrum Analysis"},subtitle:{text:"Single axis (fs=2560Hz, nperseg=65536)"},xAxis:{title:{text:"Frequency (Hz)"}},yAxis:{title:{text:"Log Amplitude"}},series:[{name:"1-Axis PSD",data:t,color:"#f59e0b",lineWidth:2,type:"line"}],legend:{enabled:!1},plotOptions:{line:{marker:{enabled:!1},states:{hover:{lineWidthPlus:1}}},scatter:{marker:{enabled:!0}}}}))}),[nt,yt]);Object(l.useEffect)((()=>{_t(),At(),A&&(D(A),St(A,T,X))}),[_,A]);const _t=async()=>{try{const e=(await h.axiosInstance.get(`api/web/machines/${_}`)).data.item;if(st(e),e&&e.rpm){const t=parseFloat(e.rpm)/60;dt([{multiplier:1,frequency:t,label:"1X",color:"#ff0000"},{multiplier:2,frequency:2*t,label:"2X",color:"#00ff00"},{multiplier:3,frequency:3*t,label:"3X",color:"#0000ff"},{multiplier:3.4,frequency:3.4*t,label:"3.4X",color:"#ff8800"},{multiplier:4,frequency:4*t,label:"4X",color:"#8800ff"},{multiplier:4.2,frequency:4.2*t,label:"4.2X",color:"#00ffff"}])}}catch(e){console.error("Error fetching machine data:",e)}},At=async()=>{try{const e=await h.axiosInstance.get(`api/web/machines/${_}/sensors`);Y(e.data.items||[])}catch(e){console.error("Error fetching sensors data:",e)}},St=async(e,t,i)=>{try{J(!0);const l=(await h.axiosInstance.get(`api/machine-data?machine_id=${_}&deviceID=${e}&start_date=${t}&end_date=${i}`)).data.data;$(l),P((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),K((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),ee((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_acceleration_p2p_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),ie((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.high_freq_acceleration_p2p_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),ae((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),oe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),se((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_displacement_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),de((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),ue((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),xe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_velocity_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),me((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),ye((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),je((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.mid_freq_env_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),Oe((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_x)||0,extraValue:null===(t=e.file_1)||void 0===t?void 0:t.replace("uploads/","")}})))),Ae((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_y)||0,extraValue:null===(t=e.file_2)||void 0===t?void 0:t.replace("uploads/","")}})))),we((()=>l.map((e=>{var t;return{x:u()(e.datetime).toDate(),y:parseFloat(e.inclination_z)||0,extraValue:null===(t=e.file_0)||void 0===t?void 0:t.replace("uploads/","")}})))),Fe((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.temperature)||0}))))),De((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.battery_percentage)||0}))))),Ye((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.battery_voltage)||0}))))),Ce((()=>l.map((e=>({x:u()(e.datetime).toDate(),y:parseFloat(e.RSSI)||0})))))}catch(l){console.error("Error fetching sensor data:",l)}finally{J(!1)}};return Object(l.useEffect)((()=>{var e;const t={mid_freq_acceleration_p2p_x:U,mid_freq_acceleration_p2p_y:Z,mid_freq_acceleration_p2p_z:N,high_freq_acceleration_p2p_z:te,mid_freq_velocity_x:ce,mid_freq_velocity_y:pe,mid_freq_velocity_z:he,mid_freq_displacement_x:le,mid_freq_displacement_y:re,mid_freq_displacement_z:ne,inclination_x:ve,inclination_y:_e,inclination_z:Se,mid_freq_env_x:be,mid_freq_env_y:fe,mid_freq_env_z:ge,temperature_:qe,battery_voltage_:Me,battery_percentage_:ze,RSSI_:He}[`${S}_${q}`]||[],i=pt[S],l=(null===i||void 0===i||null===(e=i.colors)||void 0===e?void 0:e[q])||"#ef4444",a=(null===i||void 0===i?void 0:i.unit)||"",r=`${(null===i||void 0===i?void 0:i.label)||""} ${q.toUpperCase()}`;t.length>0&&gt(t,r,a,l)}),[S,q,Q,gt]),Object(l.useEffect)((()=>{Ie&&Ie.length>0&&Xe&&!Qe&&!Ne&&(console.log("Creating single-axis spectrum chart with data length:",Ie.length),setTimeout((()=>{jt(Ie)}),100))}),[Ie,jt,Xe,Qe,Ne]),Object(l.useEffect)((()=>{Qe&&Xe&&!Ne&&Ge&&Ge.length>0&&Ue&&Ue.length>0&&Ze&&Ze.length>0&&(console.log("Creating 3-axis spectrum chart"),setTimeout((()=>{vt(Ge,Ue,Ze)}),100))}),[Ge,Ue,Ze,vt,Xe,Qe,Ne]),Object(l.useEffect)((()=>{Ne&&Xe&&tt&&lt&&lt.length>0&&(console.log("Creating multi-spectrum charts"),setTimeout((()=>{Ot(tt,lt)}),100))}),[tt,lt,Ot,Xe,Ne]),Object(m.jsxs)("div",{style:{padding:"20px"},children:[Object(m.jsx)("div",{style:{marginBottom:"20px"},children:Object(m.jsx)(o.a,{onClick:()=>O.push(`/app/machine-and-sensors/machine-details/${_}`),children:"\u2190 Back to Machine Details"})}),Object(m.jsxs)(n.a,{children:[Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",gap:"15px"},children:[Object(m.jsx)("div",{children:Object(m.jsx)("img",{src:b.a,alt:"Series"})}),Object(m.jsxs)("div",{style:{fontWeight:"bold",fontSize:"16px"},children:["Sensor Analysis ",i&&Object(m.jsx)("span",{style:{color:"#f59e0b"},children:"(Limited Features)"})]}),Object(m.jsx)("div",{children:Object(m.jsx)(o.a,{type:"primary",disabled:0===Q.length,loading:G,onClick:()=>(async(e,t,i)=>{if(0===Q.length)return void r.b.error("No data found");let l=`${x.a}/api/downloadMultipleRawFilesAndZipAndServe?machine_id=${_}&deviceID=${e}&start_date=${t}&end_date=${i}`;window.open(l,"_blank")})(z,T,X),children:"Acquire Raw Data"})}),Object(m.jsx)("div",{style:{width:"200px"},children:Object(m.jsxs)(a.a,{value:H,onChange:e=>{if("Date Range"===e)return void k(!0);let t,i;C(e),"1"===e?(t=u()().subtract(1,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"7"===e?(t=u()().subtract(7,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"30"===e?(t=u()().subtract(30,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")):"60"===e&&(t=u()().subtract(60,"days").format("YYYY-MM-DD hh:mm:ss"),i=u()().format("YYYY-MM-DD hh:mm:ss")),E(t),L(i),z&&St(z,t,i)},style:{width:"100%"},children:[Object(m.jsx)(a.a.Option,{value:"1",children:"1 Day"}),Object(m.jsx)(a.a.Option,{value:"7",children:"7 Day"}),Object(m.jsx)(a.a.Option,{value:"30",children:"30 Day"}),Object(m.jsx)(a.a.Option,{value:"60",children:"60 Day"}),Object(m.jsx)(a.a.Option,{value:"Date Range",children:"Date Range"})]})})]}),Object(m.jsx)("div",{style:{width:"300px",marginBottom:"30px"},children:Object(m.jsx)(a.a,{value:z,placeholder:"Select Sensor",onChange:e=>{D(e),localStorage.setItem("deviceId2",e),St(e,T,X)},style:{width:"100%"},children:M.map((e=>Object(m.jsx)(f,{value:e.sensor_id,children:e.sensor_type+" #"+(null!==e.sensor_id_label?e.sensor_id_label:e.sensor_id)},e.sensor_id)))})}),Xe&&Object(m.jsxs)(n.a,{title:Object(m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(m.jsx)("span",{children:Ne?"Analysis":Qe?`3-Axis Combined Spectrum (${Ge?Ge.length:0} points per axis)`:`Amplitude Spectrum (${Ie?Ie.length:0} points)`}),Object(m.jsx)(o.a,{size:"small",onClick:()=>Le(!1),children:"\u2715 Close"})]}),style:{marginBottom:"20px"},loading:Be,children:[Te&&Object(m.jsxs)("div",{style:{marginBottom:"15px",padding:"10px",background:"#f0f2f5",borderRadius:"6px"},children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("strong",{children:"Time:"})," ",u()(Te.x).format("DD-MM-YYYY HH:mm:ss")]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("strong",{children:"Value:"})," ",Te.y]})]}),!Ne&&Qe&&Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(m.jsx)("h3",{style:{color:"#1890ff",marginBottom:"15px"},children:"3-Axis Mid-Frequency Spectrum Analysis"}),Object(m.jsx)("div",{style:{width:"100%",height:"470px",overflowX:"auto"},children:Object(m.jsx)("div",{ref:g,style:{width:"100%",height:"470px"}})})]})}),!Ne&&!Qe&&Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(m.jsx)("h3",{style:{color:"#fa8c16",marginBottom:"15px"},children:"1-Axis High-Frequency Spectrum Analysis"}),Object(m.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[Object(m.jsx)("div",{style:{flex:1,height:"470px",overflowX:"auto"},children:Object(m.jsx)("div",{ref:y,style:{width:"100%",height:"470px"}})}),nt&&Object(m.jsx)("div",{style:{flexShrink:0},children:Object(m.jsxs)("div",{style:{width:"250px",border:"3px solid #fa8c16",borderRadius:"8px",padding:"12px",background:"#fff7e6"},children:[Object(m.jsx)("div",{style:{background:"#fa8c16",color:"white",padding:"6px",textAlign:"center",fontWeight:"bold",borderRadius:"4px",marginBottom:"10px"},children:"Harmonics of Rotational Frequency"}),Object(m.jsx)("table",{style:{width:"100%",fontSize:"12px"},children:Object(m.jsx)("tbody",{children:yt(Ie,nt.rpm).map(((e,t)=>Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{style:{color:e.color,fontWeight:"bold",paddingRight:"8px"},children:"\u25cf"}),Object(m.jsxs)("td",{style:{fontWeight:"bold"},children:[t+1,"st Order @"]}),Object(m.jsxs)("td",{style:{color:e.color,fontWeight:"bold",textAlign:"right"},children:[e.frequency.toFixed(1)," Hz"]}),Object(m.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:e.multiplier})]},t)))})})]})})]})]})}),Ne&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(m.jsx)("h3",{style:{color:"#1890ff",marginBottom:"15px"},children:"Mid-Frequency Analysis"}),Object(m.jsx)("div",{style:{width:"100%",height:"420px",overflowX:"auto"},children:Object(m.jsx)("div",{ref:j,style:{width:"100%",height:"420px"}})})]}),Object(m.jsxs)("div",{style:{marginBottom:"20px"},children:[Object(m.jsx)("h3",{style:{color:"#fa8c16",marginBottom:"15px"},children:"High-Frequency Analysis"}),Object(m.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[Object(m.jsx)("div",{style:{flex:1,height:"370px",overflowX:"auto"},children:Object(m.jsx)("div",{ref:v,style:{width:"100%",height:"370px"}})}),nt&&Object(m.jsx)("div",{style:{flexShrink:0},children:Object(m.jsxs)("div",{style:{width:"250px",border:"3px solid #1890ff",borderRadius:"8px",padding:"12px",background:"#e6f7ff"},children:[Object(m.jsx)("div",{style:{background:"#1890ff",color:"white",padding:"6px",textAlign:"center",fontWeight:"bold",borderRadius:"4px",marginBottom:"10px"},children:"Harmonics of Rotational Frequency"}),Object(m.jsx)("table",{style:{width:"100%",fontSize:"12px"},children:Object(m.jsx)("tbody",{children:yt(null,nt.rpm).map(((e,t)=>Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{style:{color:e.color,fontWeight:"bold",paddingRight:"8px"},children:"\u25cf"}),Object(m.jsxs)("td",{style:{fontWeight:"bold"},children:[t+1,"st Order @"]}),Object(m.jsxs)("td",{style:{color:e.color,fontWeight:"bold",textAlign:"right"},children:[e.frequency.toFixed(1)," Hz"]}),Object(m.jsx)("td",{style:{textAlign:"right",fontWeight:"bold"},children:e.multiplier})]},t)))})})]})})]})]})]})]}),Object(m.jsx)(n.a,{title:Object(m.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[Object(m.jsx)("span",{children:"Trend"}),Object(m.jsx)("div",{style:{display:"flex",gap:"5px"},children:Object.entries(pt).map((e=>{let[t,i]=e;return Object(m.jsx)("button",{onClick:()=>(e=>{var t;w(e);const i=(null===(t=pt[e])||void 0===t?void 0:t.axes)||["x"];F(i[0])})(t),style:{padding:"4px 12px",fontSize:"12px",border:"none",borderRadius:"15px",cursor:"pointer",backgroundColor:S===t?"#1890ff":"rgba(255, 255, 255, 0.1)",color:S===t?"white":"#666",transition:"all 0.2s ease"},children:i.label},t)}))})]}),((null===(e=pt[S])||void 0===e?void 0:e.axes)||[]).filter((e=>""!==e)).length>0&&Object(m.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:((null===(t=pt[S])||void 0===t?void 0:t.axes)||[]).filter((e=>""!==e)).map((e=>{var t,i;return Object(m.jsx)("button",{onClick:()=>{F(e)},style:{padding:"6px 16px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"15px",cursor:"pointer",backgroundColor:q===e?(null===(t=pt[S])||void 0===t||null===(i=t.colors)||void 0===i?void 0:i[e])||"#1890ff":"rgba(255, 255, 255, 0.1)",color:q===e?"white":"#666",transition:"all 0.2s ease",minWidth:"45px"},children:e.toUpperCase()},e)}))}),Object(m.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"15px",fontSize:"11px",color:"#666"},children:[Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(m.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#10b981"}}),Object(m.jsx)("span",{children:"Both Analyses"})]}),Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(m.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#3b82f6"}}),Object(m.jsx)("span",{children:"Mid-Frequency"})]}),Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(m.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f59e0b"}}),Object(m.jsx)("span",{children:"High-Frequency"})]}),Object(m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[Object(m.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#ef4444"}}),Object(m.jsx)("span",{children:"No Analysis"})]})]})]}),style:{marginBottom:"20px"},children:Object(m.jsx)("div",{style:{width:"100%",height:"450px",overflowX:"auto"},children:Object(m.jsx)("div",{ref:p,style:{width:"100%",height:"450px"}})})})]}),Object(m.jsxs)(s.a,{title:"Select Date Range",visible:R,onOk:()=>{if(I&&B){const e=u()(I).format("YYYY-MM-DD hh:mm:ss"),t=u()(B).format("YYYY-MM-DD hh:mm:ss");E(e),L(t),C("Date-Range"),z&&St(z,e,t)}k(!1)},onCancel:()=>k(!1),children:[Object(m.jsxs)("div",{style:{marginBottom:"16px"},children:[Object(m.jsx)("label",{children:"Start Date:"}),Object(m.jsx)(c.a,{showTime:!0,value:I?u()(I):null,onChange:e=>W(e),style:{width:"100%",marginTop:"8px"}})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("label",{children:"End Date:"}),Object(m.jsx)(c.a,{showTime:!0,value:B?u()(B):null,onChange:e=>V(e),style:{width:"100%",marginTop:"8px"}})]})]})]})}},865:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANCSURBVHgB7VVNSFRRFP7um5dmCU0gZCDkIkipQEixRYtctRIKZyaFQocIUionyJWFCrVoEc74R1GgQaGoocEEQoRCLRRdKAkVuDBo4SJqqBEGZ967fe/OjD8wozNjtig/uPPu3HPu/c4595xzgV386xApaY147Fgxq2ET5TBlUXSnCEFiEprxDI6uT0gTWxMPeuqgyXaS2AFJMrHEXQFKCjnssVP6aFQbLngXkSK0TaXDHi+E7IVJImHUI6gdxrK9GLqogNN3EBGjjAb1cdTBkOOMTCFSRHKPhzyt9LCFGqMww5ehZZ2GlM2UnI1pfKPMrzwNc03gCfWXEBQn4fYGkJHHynKSSszjw5wTIqsL0jy3jtRCnvI0IqexfGCAkXFzrQC5shMpIDGxQVL1FZU4UXKHnp6i6utVucQCx+KqATnfS/BL+CkY4/9LGGzIR9rEvS17+XueYwL7bUF60sj5AnTMrimZY9zpV1MhJ3nn5cg1qac9iMr1i0ib2N0W4n3dg9CaEAqXqmwWLJtoFsfJh1lW0QiYCDLT8zirhlyZUZkvRCnSJrZQ5XsIR/sMDziiQipIGJZXVBQk58ImYJMBFQlNkAwkEkVw9QRVuVl3nRGx1TAs7Au/4kG3OIoZUge/cyTwqfCbWi1M0cQ8mIpGQy7FTrQzJyLYAnrC1Yj8iKGbo/jJO9PlSHRRQNW0BRk3W15bt2uABpdwr13de0YeA2yBohoh1aH8SAUG7rOeHTEjJ7ZST0JsPoXVDnPRDM2sX1c6SSBbka0FGYFGpevseIuMiJ2dL2i1laG3EbY5eI8VXH2eQJOtVFxHdqhbtUxJUw3hRgrQk0oicMKGcWZvO0umADLMRMq6C5tZRIJDTKDPfJnmgaxSrORMc62Qhj5CjW8CKWDz1+nljQJmbz9nZ5R3kuUEOcVvgGV0jLvZvzmgciGiHJHiKlzeYWyLOA7raRSyFht7NSG/sqT6oJuPYRjseHve8ERGR5SRfHb7xHH0sr5zzAJomg5b+Aequr9sNLDhKIQ+zmNzeRU1cHWM/RniVNDPl00338XIK0n+Hn+F2MKa5/nJwr4zxBvJE3quYafg6uGbHalQFSDkceziv8Nv8F43RRMAsBQAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=56.6452bddc.chunk.js.map