(this.webpackJsonpemilus=this.webpackJsonpemilus||[]).push([[57],{1380:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(232),i=a(189),c=a(596),r=a(571),l=a(588),d=a(532),o=a(577),j=a(534),h=a(109),m=a(637),b=a(672),x=a(544),u=a(679),O=a(703),p=a(554),g=a(550),y=a(328),I=a(697),v=a.n(I),f=a(613),w=a(141),S=a(125),_=a(578),k=a.n(_),M=a(663),A=a.n(M),C=a(65),N=a(1);t.default=()=>{const e=Object(w.useHistory)(),[t,a]=Object(s.useState)([]),[I,_]=Object(s.useState)(!1);Object(s.useEffect)((()=>{M()}),[]);const M=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=[];""!==e&&"all"!==e&&s.push(`health=${e}`),""!==t&&"all"!==t&&s.push(`machine_status=${t}`);let n=s.length?`&${s.join("&")}`:"";try{_(!0);const e=await S.axiosInstance.get(`api/web/machines?customer_id=${"null"!=localStorage.getItem("parent_id")?localStorage.getItem("parent_id"):localStorage.getItem("user_id")}${n}`);if(200===e.status){const t=e.data.items;Array.isArray(t)?(a(t),_(!1)):console.error("Unexpected response format:",t)}}catch(i){_(!1),console.error("Error fetching data:",i)}},$=t=>Object(N.jsxs)(i.a,{children:[Object(N.jsxs)(i.a.Item,{onClick:()=>e.push(`/app/machine-and-sensors/machine-details/${t.id}`),children:[Object(N.jsx)(b.a,{})," View Details"]},"edit"),Object(N.jsxs)(i.a.Item,{onClick:()=>e.push(`/app/machine-and-sensors/sensor-list/${t.id}`),children:[Object(N.jsx)(b.a,{})," View Sensors"]},"viewSensors"),Object(C.e)("machines_and_sensors","Edit Machines and Sensors")&&Object(N.jsxs)(i.a.Item,{onClick:()=>e.push(`/app/machine-and-sensors/edit/${t.id}`),children:[Object(N.jsx)(x.a,{})," Edit Details"]},"edit-machine"),Object(C.e)("machines_and_sensors","Delete Machines and Sensors")&&Object(N.jsx)(c.a,{title:"Are you sure you want to delete this item?",description:"This action cannot be undone.",okText:"Yes",cancelText:"No",onConfirm:()=>(async e=>{console.log(e);try{200===(await S.axiosInstance.delete(`api/web/machines/${e}`)).status&&(n.b.success("Machine deleted successfully"),a((t=>t.filter((t=>t.id!==e)))))}catch(i){var t,s;console.error("Error deleting row:",i),n.b.error((null===(t=i.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Error deleting machine. Please try again.")}})(t.id),children:Object(N.jsx)(i.a.Item,{children:Object(N.jsxs)("span",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[Object(N.jsx)(u.a,{})," Delete"]})},"delete")})]}),D=[{title:"ID",dataIndex:"id",key:"id"},{title:"Customer",dataIndex:"user",key:"name",render:(e,t)=>(null===e||void 0===e?void 0:e.name)||"N/A"},{title:"Jobsite",dataIndex:"job_site",key:"Jobsite",render:(e,t)=>(null===e||void 0===e?void 0:e.jobsite_name)||"N/A"},{title:"Machines",dataIndex:"name",key:"machine_detail"},{title:"Active Since",dataIndex:"created_at",key:"created_at",render:e=>Object(N.jsx)(N.Fragment,{children:k()(e).format("DD-MM-YYYY, h:mm a")})},{title:"Machine Status",dataIndex:"machine_status",key:"machine_status",render:e=>e?Object(N.jsx)(r.a,{color:"green",children:"Active"}):Object(N.jsx)(r.a,{color:"red",children:"Inactive"})},{title:"Overall Status",dataIndex:"health",key:"health",render:e=>e<=10&&e>=8?Object(N.jsx)(r.a,{color:"green",children:"Good"}):e<=7&&e>=6?Object(N.jsx)(r.a,{color:"yellow",children:"Satisfactory"}):e<=5&&e>=3?Object(N.jsx)(r.a,{color:"orange",children:"Warning"}):Object(N.jsx)(r.a,{color:"red",children:"Critical"})},{title:"Action",key:"action",render:(e,t)=>Object(N.jsx)(l.b,{size:"middle",children:Object(N.jsx)(d.a,{overlay:$(t),placement:"bottomRight",trigger:["hover"],children:Object(N.jsx)(O.a,{})})})}],[E,Y]=Object(s.useState)("all"),[J,T]=Object(s.useState)("all");i.a,A.a,i.a.Item,o.a,i.a.Item,o.a,i.a.Item,o.a,i.a.Item,o.a,i.a.Item,o.a,A.a,i.a.Item,o.a,i.a.Item,o.a,i.a.Item,o.a;return Object(N.jsxs)("div",{children:[Object(N.jsxs)("h4",{children:[Object(N.jsx)(p.a,{})," Machine & Sensors"]}),Object(N.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[Object(N.jsxs)("div",{style:{display:"flex"},children:[Object(N.jsx)(l.b,{direction:"vertical",children:Object(N.jsx)(j.a,{placeholder:"Search",allowClear:!0,onChange:e=>{},style:{width:200},prefix:Object(N.jsx)(g.a,{style:{marginRight:8}})})}),Object(N.jsx)(h.a,{icon:Object(N.jsx)(v.a,{component:y.e}),className:"d-flex align-items-center ml-2",children:"Export"})]}),Object(C.e)("machines_and_sensors","Create New Machines and Sensors")&&Object(N.jsx)("div",{className:"mb-2 d-flex align-items-center",children:Object(N.jsx)(h.a,{className:"ml-3 bg-primary d-flex align-items-center rounded text-white font-weight-semibold px-4",children:Object(N.jsx)(f.Link,{to:"machine-and-sensors/add-new",children:"+ Add New Machines"})})})]}),Object(N.jsx)(m.a,{loading:I,dataSource:t,columns:D})]})}}}]);
//# sourceMappingURL=57.92dd57db.chunk.js.map